{"version":3,"file":"groupfolders-sharing.js?v=cfb3a8675b40e3be88e4","mappings":"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ACX,OAAOvC,KAAKsC,KAAKJ,EAAKK,GAAOvC,KAAKyC,MAAMP,EAAKK,GAAOvC,KAAKwC,IAAIN,EAAKK,EAClE,u1BCyHF,WAEA,MChLmL,EDgLnL,CACA,0BACA,YACA,aAEA,YACA,aACA,kBACA,aACA,iBACA,SACA,iBAEA,OACA,UACA,YACA,cAGA,KAnBA,WAoBA,OACA,cACA,gBACA,iBACA,mBACA,WACA,eACA,WACA,WACA,WACA,QAEA,EACA,UACA,QADA,WAEA,wBACA,EACA,YAJA,WAKA,uBACA,gBACA,CACA,EACA,UATA,WAUA,qBACA,aACA,CACA,EACA,SAdA,WAcA,WACA,uBAGA,OAFA,wBACA,gBAEA,CACA,GAEA,OACA,SADA,WAGA,eACA,GAEA,YA7DA,WA+DA,eACA,EACA,SACA,SADA,WACA,WACA,gBACA,gBACA,qDACA,2CACA,SACA,eAEA,wCACA,0BACA,8BACA,gCACA,aACA,oBACA,GACA,EACA,mBAjBA,SAiBA,KACA,kBACA,wDAGA,CACA,EACA,eAxBA,SAwBA,cACA,GACA,0DAEA,2BACA,oBACA,uHACA,sBACA,kBACA,iBACA,6DACA,OACA,sBACA,aACA,SACA,0BAEA,IACA,wDACA,OACA,qBACA,YACA,SACA,0BAEA,IACA,mDAEA,mFACA,GACA,IAxBA,OAwBA,YACA,iBACA,yDAEA,GACA,EACA,gBA5DA,WA4DA,WACA,uCACA,0BACA,0BACA,GACA,EACA,UAlEA,SAkEA,cACA,UACA,6CACA,kBACA,qDACA,kBACA,GACA,EACA,UA1EA,SA0EA,cACA,uBACA,uBACA,MACA,cAEA,6CACA,mBACA,0DACA,SACA,oBAEA,GAEA,EACA,iBAzFA,SAyFA,OACA,2BACA,MACA,WACA,iBACA,YACA,EACA,0BAGA,uBAEA,cADA,EACA,uBAEA,0BAGA,eACA,wBACA,qDAEA,GACA,mBErVI,EAAU,CAAC,EAEf,EAAQ7C,kBAAoB,IAC5B,EAAQC,cAAgB,IAElB,EAAQC,OAAS,SAAc,KAAM,QAE3C,EAAQC,OAAS,IACjB,EAAQC,mBAAqB,IAEhB,IAA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","sources":["webpack:///groupfolders/src/components/AclStateButton.vue","webpack:///groupfolders/src/components/AclStateButton.vue?vue&type=script&lang=js&","webpack://groupfolders/./src/components/AclStateButton.vue?d3e3","webpack://groupfolders/./src/components/AclStateButton.vue?8735","webpack:///groupfolders/src/components/AclStateButton.vue?vue&type=template&id=22b0874a&scoped=true&","webpack:///groupfolders/src/BinaryTools.js","webpack:///groupfolders/src/components/SharingSidebarView.vue","webpack:///groupfolders/src/components/SharingSidebarView.vue?vue&type=script&lang=js&","webpack://groupfolders/./src/components/SharingSidebarView.vue?34cd","webpack://groupfolders/./src/components/SharingSidebarView.vue?af13","webpack:///groupfolders/src/components/SharingSidebarView.vue?vue&type=template&id=01e5fc40&scoped=true&","webpack:///groupfolders/src/SharingSidebarApp.js","webpack:///groupfolders/src/components/AclStateButton.vue?vue&type=style&index=0&id=22b0874a&scoped=true&lang=css&","webpack:///groupfolders/src/components/SharingSidebarView.vue?vue&type=style&index=0&id=01e5fc40&scoped=true&lang=css&"],"sourcesContent":["<!--\n  - @copyright Copyright (c) 2018 Julius Härtl <jus@bitgrid.net>\n  -\n  - @author Julius Härtl <jus@bitgrid.net>\n  -\n  - @license GNU AGPL version 3 or any later version\n  -\n  - This program is free software: you can redistribute it and/or modify\n  - it under the terms of the GNU Affero General Public License as\n  - published by the Free Software Foundation, either version 3 of the\n  - License, or (at your option) any later version.\n  -\n  - This program is distributed in the hope that it will be useful,\n  - but WITHOUT ANY WARRANTY; without even the implied warranty of\n  - MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n  - GNU Affero General Public License for more details.\n  -\n  - You should have received a copy of the GNU Affero General Public License\n  - along with this program. If not, see <http://www.gnu.org/licenses/>.\n  -\n  -->\n<template>\n\t<div v-if=\"readOnly\">\n\t\t<NcButton v-if=\"!isAllowed\" v-tooltip=\"t('groupfolders', 'Denied')\">\n\t\t\t<Cancel :size=\"16\" />\n\t\t</NcButton>\n\t\t<NcButton v-else v-tooltip=\"t('groupfolders', 'Allowed')\">\n\t\t\t<Check :size=\"16\" />\n\t\t</NcButton>\n\t</div>\n\t<div v-else>\n\t\t<NcActions :aria-label=\"label\" :v-tooltip=\"label\">\n\t\t\t<template #icon>\n\t\t\t\t<component :is=\"icon\" :size=\"16\" />\n\t\t\t</template>\n\t\t\t<NcActionRadio name=\"state\"\n\t\t\t\t:checked=\"state === STATES.INHERIT_ALLOW || state === STATES.INHERIT_DENY\"\n\t\t\t\t:disabled=\"disabled\"\n\t\t\t\t@change=\"$emit('update', STATES.INHERIT_ALLOW)\">\n\t\t\t\t{{ t('groupfolders', 'Inherit permission') }}\n\t\t\t</NcActionRadio>\n\t\t\t<NcActionRadio name=\"state\"\n\t\t\t\t:check=\"state === STATES.SELF_DENY\"\n\t\t\t\t:disabled=\"disabled\"\n\t\t\t\t@change=\"$emit('update', STATES.SELF_DENY)\">\n\t\t\t\t{{ t('groupfolders', 'Deny') }}\n\t\t\t</NcActionRadio>\n\t\t\t<NcActionRadio name=\"state\"\n\t\t\t\t:check=\"state === STATES.SELF_ALLOW\"\n\t\t\t\t:disabled=\"disabled\"\n\t\t\t\t@change=\"$emit('update', STATES.SELF_ALLOW)\">\n\t\t\t\t{{ t('groupfolders', 'Allow') }}\n\t\t\t</NcActionRadio>\n\t\t</NcActions>\n\t</div>\n</template>\n\n<script>\nimport Check from 'vue-material-design-icons/Check.vue'\nimport Cancel from 'vue-material-design-icons/Cancel.vue'\nimport NcButton from '@nextcloud/vue/dist/Components/NcButton.js'\nimport NcPopoverMenu from '@nextcloud/vue/dist/Components/NcPopoverMenu.js'\nimport NcActions from '@nextcloud/vue/dist/Components/NcActions.js'\nimport NcActionRadio from '@nextcloud/vue/dist/Components/NcActionRadio.js'\nimport Tooltip from '@nextcloud/vue/dist/Directives/Tooltip.js'\n\nconst STATES = {\n\tINHERIT_DENY: 0,\n\tINHERIT_ALLOW: 1,\n\tSELF_DENY: 2,\n\tSELF_ALLOW: 3,\n}\n\nexport default {\n\tname: 'AclStateButton',\n\tdirectives: {\n\t\ttooltip: Tooltip,\n\t},\n\tcomponents: {\n\t\tNcPopoverMenu,\n\t\tNcButton,\n\t\tNcActions,\n\t\tNcActionRadio,\n\t\tCheck,\n\t\tCancel,\n\t},\n\tprops: {\n\t\tinherited: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t\tstate: {\n\t\t\ttype: Number,\n\t\t\tdefault: STATES.INHERIT_DENY,\n\t\t},\n\t\treadOnly: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t\tdisabled: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tSTATES,\n\t\t}\n\t},\n\tcomputed: {\n\t\tisAllowed() {\n\t\t\treturn this.state & 1\n\t\t},\n\t\ticon() {\n\t\t\tswitch (this.state) {\n\t\t\tcase STATES.INHERIT_ALLOW:\n\t\t\tcase STATES.SELF_ALLOW:\n\t\t\t\treturn Check\n\t\t\tdefault:\n\t\t\t\treturn Cancel\n\t\t\t}\n\t\t},\n\t\tlabel() {\n\t\t\tswitch (this.state) {\n\t\t\tcase STATES.INHERIT_DENY:\n\t\t\t\treturn t('groupfolders', 'Denied (Inherited permission)')\n\t\t\tcase STATES.INHERIT_ALLOW:\n\t\t\t\treturn t('groupfolders', 'Allowed (Inherited permission)')\n\t\t\tcase STATES.SELF_DENY:\n\t\t\t\treturn t('groupfolders', 'Denied')\n\t\t\tcase STATES.SELF_ALLOW:\n\t\t\t\treturn t('groupfolders', 'Allowed')\n\t\t\t}\n\t\t\treturn ''\n\t\t},\n\t},\n}\n</script>\n\n<style scoped>\n\t.inherited {\n\t\topacity: 0.5;\n\t}\n</style>\n","import mod from \"-!../../node_modules/babel-loader/lib/index.js!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AclStateButton.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/babel-loader/lib/index.js!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AclStateButton.vue?vue&type=script&lang=js&\"","\n      import API from \"!../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../node_modules/style-loader/dist/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../node_modules/style-loader/dist/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../node_modules/style-loader/dist/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../node_modules/style-loader/dist/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../node_modules/css-loader/dist/cjs.js!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AclStateButton.vue?vue&type=style&index=0&id=22b0874a&scoped=true&lang=css&\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\n\n      options.insert = insertFn.bind(null, \"head\");\n    \noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../node_modules/css-loader/dist/cjs.js!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AclStateButton.vue?vue&type=style&index=0&id=22b0874a&scoped=true&lang=css&\";\n       export default content && content.locals ? content.locals : undefined;\n","import { render, staticRenderFns } from \"./AclStateButton.vue?vue&type=template&id=22b0874a&scoped=true&\"\nimport script from \"./AclStateButton.vue?vue&type=script&lang=js&\"\nexport * from \"./AclStateButton.vue?vue&type=script&lang=js&\"\nimport style0 from \"./AclStateButton.vue?vue&type=style&index=0&id=22b0874a&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"22b0874a\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return (_vm.readOnly)?_c('div',[(!_vm.isAllowed)?_c('NcButton',{directives:[{name:\"tooltip\",rawName:\"v-tooltip\",value:(_vm.t('groupfolders', 'Denied')),expression:\"t('groupfolders', 'Denied')\"}]},[_c('Cancel',{attrs:{\"size\":16}})],1):_c('NcButton',{directives:[{name:\"tooltip\",rawName:\"v-tooltip\",value:(_vm.t('groupfolders', 'Allowed')),expression:\"t('groupfolders', 'Allowed')\"}]},[_c('Check',{attrs:{\"size\":16}})],1)],1):_c('div',[_c('NcActions',{attrs:{\"aria-label\":_vm.label,\"v-tooltip\":_vm.label},scopedSlots:_vm._u([{key:\"icon\",fn:function(){return [_c(_vm.icon,{tag:\"component\",attrs:{\"size\":16}})]},proxy:true}])},[_vm._v(\" \"),_c('NcActionRadio',{attrs:{\"name\":\"state\",\"checked\":_vm.state === _vm.STATES.INHERIT_ALLOW || _vm.state === _vm.STATES.INHERIT_DENY,\"disabled\":_vm.disabled},on:{\"change\":function($event){return _vm.$emit('update', _vm.STATES.INHERIT_ALLOW)}}},[_vm._v(\"\\n\\t\\t\\t\"+_vm._s(_vm.t('groupfolders', 'Inherit permission'))+\"\\n\\t\\t\")]),_vm._v(\" \"),_c('NcActionRadio',{attrs:{\"name\":\"state\",\"check\":_vm.state === _vm.STATES.SELF_DENY,\"disabled\":_vm.disabled},on:{\"change\":function($event){return _vm.$emit('update', _vm.STATES.SELF_DENY)}}},[_vm._v(\"\\n\\t\\t\\t\"+_vm._s(_vm.t('groupfolders', 'Deny'))+\"\\n\\t\\t\")]),_vm._v(\" \"),_c('NcActionRadio',{attrs:{\"name\":\"state\",\"check\":_vm.state === _vm.STATES.SELF_ALLOW,\"disabled\":_vm.disabled},on:{\"change\":function($event){return _vm.$emit('update', _vm.STATES.SELF_ALLOW)}}},[_vm._v(\"\\n\\t\\t\\t\"+_vm._s(_vm.t('groupfolders', 'Allow'))+\"\\n\\t\\t\")])],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","/*\n * @copyright Copyright (c) 2018 Julius Härtl <jus@bitgrid.net>\n *\n * @author Julius Härtl <jus@bitgrid.net>\n *\n * @license GNU AGPL version 3 or any later version\n *\n *  This program is free software: you can redistribute it and/or modify\n *  it under the terms of the GNU Affero General Public License as\n *  published by the Free Software Foundation, either version 3 of the\n *  License, or (at your option) any later version.\n *\n *  This program is distributed in the hope that it will be useful,\n *  but WITHOUT ANY WARRANTY; without even the implied warranty of\n *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *  GNU Affero General Public License for more details.\n *\n *  You should have received a copy of the GNU Affero General Public License\n *  along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nconst BinaryTools = {\n\ttoString(num) {\n\t\treturn (num >>> 0).toString(2).padStart(8, '0')\n\t},\n\n\tfirstHigh(num) {\n\t\tlet position = 0\n\t\twhile (num !== 0) {\n\t\t\tif (num & 1 > 0) {\n\t\t\t\treturn position\n\t\t\t}\n\t\t\tposition++\n\t\t\tnum = num >> 1\n\t\t}\n\t\treturn 0\n\t},\n\n\ttest(num, bit) {\n\t\treturn ((num >> bit) % 2 !== 0)\n\t},\n\n\tset(num, bit) {\n\t\treturn num | 1 << bit\n\t},\n\n\tclear(num, bit) {\n\t\treturn num & ~(1 << bit)\n\t},\n\n\ttoggle(num, bit) {\n\t\treturn this.test(num, bit) ? this.clear(num, bit) : this.set(num, bit)\n\t},\n}\n\nexport default BinaryTools\n","<!--\n  - @copyright Copyright (c) 2018 Julius Härtl <jus@bitgrid.net>\n  -\n  - @author Julius Härtl <jus@bitgrid.net>\n  -\n  - @license GNU AGPL version 3 or any later version\n  -\n  - This program is free software: you can redistribute it and/or modify\n  - it under the terms of the GNU Affero General Public License as\n  - published by the Free Software Foundation, either version 3 of the\n  - License, or (at your option) any later version.\n  -\n  - This program is distributed in the hope that it will be useful,\n  - but WITHOUT ANY WARRANTY; without even the implied warranty of\n  - MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n  - GNU Affero General Public License for more details.\n  -\n  - You should have received a copy of the GNU Affero General Public License\n  - along with this program. If not, see <http://www.gnu.org/licenses/>.\n  -\n  -->\n<template>\n\t<div v-if=\"aclEnabled && !loading\" id=\"groupfolder-acl-container\">\n\t\t<div class=\"groupfolder-entry\">\n\t\t\t<div class=\"avatar icon-group-white\" />\n\t\t\t<span class=\"username\" />\n\t\t</div>\n\t\t<table>\n\t\t\t<thead>\n\t\t\t\t<tr>\n\t\t\t\t\t<th />\n\t\t\t\t\t<th>{{ t('groupfolders', 'Group folder') }}</th>\n\t\t\t\t\t<th v-tooltip=\"t('groupfolders', 'Read')\" class=\"state-column\">\n\t\t\t\t\t\t{{ t('groupfolders', 'Read') }}\n\t\t\t\t\t</th>\n\t\t\t\t\t<th v-tooltip=\"t('groupfolders', 'Write')\" class=\"state-column\">\n\t\t\t\t\t\t{{ t('groupfolders', 'Write') }}\n\t\t\t\t\t</th>\n\t\t\t\t\t<th v-if=\"model.type === 'dir'\" v-tooltip=\"t('groupfolders', 'Create')\" class=\"state-column\">\n\t\t\t\t\t\t{{\n\t\t\t\t\t\t\tt('groupfolders', 'Create') }}\n\t\t\t\t\t</th>\n\t\t\t\t\t<th v-tooltip=\"t('groupfolders', 'Delete')\" class=\"state-column\">\n\t\t\t\t\t\t{{ t('groupfolders', 'Delete') }}\n\t\t\t\t\t</th>\n\t\t\t\t\t<th v-tooltip=\"t('groupfolders', 'Share')\" class=\"state-column\">\n\t\t\t\t\t\t{{ t('groupfolders', 'Share') }}\n\t\t\t\t\t</th>\n\t\t\t\t\t<th class=\"state-column\" />\n\t\t\t\t</tr>\n\t\t\t</thead>\n\t\t\t<tbody v-if=\"!isAdmin\">\n\t\t\t\t<tr>\n\t\t\t\t\t<td>\n\t\t\t\t\t\t<NcAvatar user=\"admin\" :size=\"24\" />\n\t\t\t\t\t</td>\n\t\t\t\t\t<td class=\"username\">\n\t\t\t\t\t\t{{ t('groupfolders', 'You') }}\n\t\t\t\t\t</td>\n\t\t\t\t\t<td class=\"state-column\">\n\t\t\t\t\t\t<AclStateButton :state=\"getState(OC.PERMISSION_READ, model.permissions, 1)\" :read-only=\"true\" />\n\t\t\t\t\t</td>\n\t\t\t\t\t<td class=\"state-column\">\n\t\t\t\t\t\t<AclStateButton :state=\"getState(OC.PERMISSION_UPDATE, model.permissions, 1)\" :read-only=\"true\" />\n\t\t\t\t\t</td>\n\t\t\t\t\t<td v-if=\"model.type === 'dir'\" class=\"state-column\">\n\t\t\t\t\t\t<AclStateButton :state=\"getState(OC.PERMISSION_CREATE, model.permissions, 1)\" :read-only=\"true\" />\n\t\t\t\t\t</td>\n\t\t\t\t\t<td class=\"state-column\">\n\t\t\t\t\t\t<AclStateButton :state=\"getState(OC.PERMISSION_DELETE, model.permissions, 1)\" :read-only=\"true\" />\n\t\t\t\t\t</td>\n\t\t\t\t\t<td class=\"state-column\">\n\t\t\t\t\t\t<AclStateButton :state=\"getState(OC.PERMISSION_SHARE, model.permissions, 1)\" :read-only=\"true\" />\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\t\t\t</tbody>\n\t\t\t<tbody v-else>\n\t\t\t\t<tr v-for=\"item in list\" :key=\"item.mappingType + '-' + item.mappingId\">\n\t\t\t\t\t<td>\n\t\t\t\t\t\t<NcAvatar :user=\"item.mappingId\" :is-no-user=\"item.mappingType !== 'user'\" :size=\"24\" />\n\t\t\t\t\t</td>\n\t\t\t\t\t<td v-tooltip=\"getFullDisplayName(item.mappingDisplayName, item.mappingType)\" class=\"username\">\n\t\t\t\t\t\t{{ getFullDisplayName(item.mappingDisplayName, item.mappingType) }}\n\t\t\t\t\t</td>\n\t\t\t\t\t<td class=\"state-column\">\n\t\t\t\t\t\t<AclStateButton :state=\"getState(OC.PERMISSION_READ, item.permissions, item.mask)\"\n\t\t\t\t\t\t\t:inherited=\"item.inherited\"\n\t\t\t\t\t\t\t:disabled=\"loading\"\n\t\t\t\t\t\t\t@update=\"changePermission(item, OC.PERMISSION_READ, $event)\" />\n\t\t\t\t\t</td>\n\t\t\t\t\t<td class=\"state-column\">\n\t\t\t\t\t\t<AclStateButton :state=\"getState(OC.PERMISSION_UPDATE, item.permissions, item.mask)\"\n\t\t\t\t\t\t\t:inherited=\"item.inherited\"\n\t\t\t\t\t\t\t:disabled=\"loading\"\n\t\t\t\t\t\t\t@update=\"changePermission(item, OC.PERMISSION_UPDATE, $event)\" />\n\t\t\t\t\t</td>\n\t\t\t\t\t<td v-if=\"model.type === 'dir'\" class=\"state-column\">\n\t\t\t\t\t\t<AclStateButton :state=\"getState(OC.PERMISSION_CREATE, item.permissions, item.mask)\"\n\t\t\t\t\t\t\t:inherited=\"item.inherited\"\n\t\t\t\t\t\t\t:disabled=\"loading\"\n\t\t\t\t\t\t\t@update=\"changePermission(item, OC.PERMISSION_CREATE, $event)\" />\n\t\t\t\t\t</td>\n\t\t\t\t\t<td class=\"state-column\">\n\t\t\t\t\t\t<AclStateButton :state=\"getState(OC.PERMISSION_DELETE, item.permissions, item.mask)\"\n\t\t\t\t\t\t\t:inherited=\"item.inherited\"\n\t\t\t\t\t\t\t:disabled=\"loading\"\n\t\t\t\t\t\t\t@update=\"changePermission(item, OC.PERMISSION_DELETE, $event)\" />\n\t\t\t\t\t</td>\n\t\t\t\t\t<td class=\"state-column\">\n\t\t\t\t\t\t<AclStateButton :state=\"getState(OC.PERMISSION_SHARE, item.permissions, item.mask)\"\n\t\t\t\t\t\t\t:inherited=\"item.inherited\"\n\t\t\t\t\t\t\t:disabled=\"loading\"\n\t\t\t\t\t\t\t@update=\"changePermission(item, OC.PERMISSION_SHARE, $event)\" />\n\t\t\t\t\t</td>\n\t\t\t\t\t<td class=\"state-column\">\n\t\t\t\t\t\t<NcButton v-if=\"item.inherited === false\"\n\t\t\t\t\t\t\ttype=\"tertiary\"\n\t\t\t\t\t\t\t:v-tooltip=\"t('groupfolders', 'Remove access rule')\"\n\t\t\t\t\t\t\t:aria-label=\"t('groupfolders', 'Remove access rule')\"\n\t\t\t\t\t\t\t@click=\"removeAcl(item)\">\n\t\t\t\t\t\t\t<template #icon>\n\t\t\t\t\t\t\t\t<Close :size=\"16\" />\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t</NcButton>\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\t\t\t</tbody>\n\t\t</table>\n\t\t<NcButton v-if=\"isAdmin && !loading && !showAclCreate\"\n\t\t\t@click=\"toggleAclCreate\">\n\t\t\t<template #icon>\n\t\t\t\t<Plus :size=\"16\" />\n\t\t\t</template>\n\t\t\t{{ t('groupfolders', 'Add advanced permission rule') }}\n\t\t</NcButton>\n\t\t<NcMultiselect v-if=\"isAdmin && !loading\"\n\t\t\tv-show=\"showAclCreate\"\n\t\t\tref=\"select\"\n\t\t\tv-model=\"value\"\n\t\t\t:options=\"options\"\n\t\t\t:reset-after=\"true\"\n\t\t\t:loading=\"isSearching\"\n\t\t\t:internal-search=\"false\"\n\t\t\t:placeholder=\"t('groupfolders', 'Select a user or group')\"\n\t\t\ttrack-by=\"unique\"\n\t\t\t@select=\"createAcl\"\n\t\t\t@search-change=\"searchMappings\">\n\t\t\t<template slot=\"singleLabel\" slot-scope=\"props\">\n\t\t\t\t<NcAvatar :user=\"props.option.id\" :is-no-user=\"props.option.type !== 'user'\" />\n\t\t\t\t{{ getFullDisplayName(props.option.displayname, props.option.type) }}\n\t\t\t</template>\n\t\t\t<template slot=\"option\" slot-scope=\"props\">\n\t\t\t\t<NcAvatar :user=\"props.option.id\" :is-no-user=\"props.option.type !== 'user'\" />\n\t\t\t\t{{ getFullDisplayName(props.option.displayname, props.option.type) }}\n\t\t\t</template>\n\t\t</NcMultiselect>\n\t</div>\n</template>\n\n<script>\nimport Vue from 'vue'\nimport axios from '@nextcloud/axios'\nimport { generateUrl } from '@nextcloud/router'\nimport AclStateButton from './AclStateButton.vue'\nimport Rule from './../model/Rule.js'\nimport BinaryTools from './../BinaryTools.js'\nimport client from './../client.js'\nimport NcButton from '@nextcloud/vue/dist/Components/NcButton.js'\nimport NcAvatar from '@nextcloud/vue/dist/Components/NcAvatar.js'\nimport NcMultiselect from '@nextcloud/vue/dist/Components/NcMultiselect.js'\nimport Tooltip from '@nextcloud/vue/dist/Directives/Tooltip.js'\nimport Plus from 'vue-material-design-icons/Plus.vue'\nimport Close from 'vue-material-design-icons/Close.vue'\n\nlet searchRequestCancelSource = null\n\nexport default {\n\tname: 'SharingSidebarView',\n\tdirectives: {\n\t\ttooltip: Tooltip,\n\t},\n\tcomponents: {\n\t\tNcAvatar,\n\t\tNcMultiselect,\n\t\tNcButton,\n\t\tAclStateButton,\n\t\tPlus,\n\t\tClose,\n\t},\n\tprops: {\n\t\tfileInfo: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata() {\n\t\treturn {\n\t\t\taclEnabled: false,\n\t\t\taclCanManage: false,\n\t\t\tshowAclCreate: false,\n\t\t\tgroupFolderId: null,\n\t\t\tloading: false,\n\t\t\tisSearching: false,\n\t\t\toptions: [],\n\t\t\tvalue: null,\n\t\t\tmodel: null,\n\t\t\tlist: [],\n\t\t}\n\t},\n\tcomputed: {\n\t\tisAdmin() {\n\t\t\treturn this.aclCanManage\n\t\t},\n\t\tisInherited() {\n\t\t\treturn (permission, permissions, mask) => {\n\t\t\t\treturn (permission & ~mask) === 0\n\t\t\t}\n\t\t},\n\t\tisAllowed() {\n\t\t\treturn (permission, permissions) => {\n\t\t\t\treturn (permission & permissions) > 0\n\t\t\t}\n\t\t},\n\t\tgetState() {\n\t\t\treturn (permission, permissions, mask) => {\n\t\t\t\tconst inheritance = this.isInherited(permission, permissions, mask) << 1\n\t\t\t\tconst permitted = this.isAllowed(permission, permissions)\n\t\t\t\treturn inheritance | permitted\n\t\t\t}\n\t\t},\n\t},\n\twatch: {\n\t\tfileInfo(/* newVal, oldVal */) {\n\t\t\t// reload ACL entries if file changes\n\t\t\tthis.loadAcls()\n\t\t},\n\t},\n\tbeforeMount() {\n\t\t// load ACL entries for initial file\n\t\tthis.loadAcls()\n\t},\n\tmethods: {\n\t\tloadAcls() {\n\t\t\tthis.options = []\n\t\t\tthis.loading = true\n\t\t\tthis.model = JSON.parse(JSON.stringify(this.fileInfo))\n\t\t\tclient.propFind(this.model).then((data) => {\n\t\t\t\tif (data.acls) {\n\t\t\t\t\tthis.list = data.acls\n\t\t\t\t}\n\t\t\t\tthis.inheritedAclsById = data.inheritedAclsById\n\t\t\t\tthis.aclEnabled = data.aclEnabled\n\t\t\t\tthis.aclCanManage = data.aclCanManage\n\t\t\t\tthis.groupFolderId = data.groupFolderId\n\t\t\t\tthis.loading = false\n\t\t\t\tthis.searchMappings('')\n\t\t\t})\n\t\t},\n\t\tgetFullDisplayName(displayName, type) {\n\t\t\tif (type === 'group') {\n\t\t\t\treturn `${displayName} (${t('groupfolders', 'Group')})`\n\t\t\t}\n\n\t\t\treturn displayName\n\t\t},\n\t\tsearchMappings(query) {\n\t\t\tif (searchRequestCancelSource) {\n\t\t\t\tsearchRequestCancelSource.cancel('Operation canceled by another search request.')\n\t\t\t}\n\t\t\tsearchRequestCancelSource = axios.CancelToken.source()\n\t\t\tthis.isSearching = true\n\t\t\taxios.get(generateUrl(`apps/groupfolders/folders/${this.groupFolderId}/search`) + '?format=json&search=' + query, {\n\t\t\t\tcancelToken: searchRequestCancelSource.token,\n\t\t\t}).then((result) => {\n\t\t\t\tthis.isSearching = false\n\t\t\t\tconst groups = Object.values(result.data.ocs.data.groups).map((group) => {\n\t\t\t\t\treturn {\n\t\t\t\t\t\tunique: 'group:' + group.gid,\n\t\t\t\t\t\ttype: 'group',\n\t\t\t\t\t\tid: group.gid,\n\t\t\t\t\t\tdisplayname: group.displayname,\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\tconst users = Object.values(result.data.ocs.data.users).map((user) => {\n\t\t\t\t\treturn {\n\t\t\t\t\t\tunique: 'user:' + user.uid,\n\t\t\t\t\t\ttype: 'user',\n\t\t\t\t\t\tid: user.uid,\n\t\t\t\t\t\tdisplayname: user.displayname,\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\tthis.options = [...groups, ...users].filter((entry) => {\n\t\t\t\t\t// filter out existing acl rules\n\t\t\t\t\treturn !this.list.find((existingAcl) => entry.unique === existingAcl.getUniqueMappingIdentifier())\n\t\t\t\t})\n\t\t\t}).catch((error) => {\n\t\t\t\tif (!axios.isCancel(error)) {\n\t\t\t\t\tconsole.error('Failed to l search results for groupfolder ACL')\n\t\t\t\t}\n\t\t\t})\n\t\t},\n\t\ttoggleAclCreate() {\n\t\t\tthis.showAclCreate = !this.showAclCreate\n\t\t\tVue.nextTick(() => {\n\t\t\t\tthis.$refs.select.$el.focus()\n\t\t\t})\n\t\t},\n\t\tcreateAcl(option) {\n\t\t\tconst rule = new Rule()\n\t\t\trule.fromValues(option.type, option.id, option.displayname, 0b00000, 0b11111)\n\t\t\tthis.list.push(rule)\n\t\t\tclient.propPatch(this.model, this.list).then(() => {\n\t\t\t\tthis.showAclCreate = false\n\t\t\t})\n\t\t},\n\t\tremoveAcl(rule) {\n\t\t\tconst index = this.list.indexOf(rule)\n\t\t\tconst list = this.list.concat([]) // shallow clone\n\t\t\tif (index > -1) {\n\t\t\t\tlist.splice(index, 1)\n\t\t\t}\n\t\t\tclient.propPatch(this.model, list).then(() => {\n\t\t\t\tthis.list.splice(index, 1)\n\t\t\t\tconst inheritedAcl = this.inheritedAclsById[rule.getUniqueMappingIdentifier()]\n\t\t\t\tif (inheritedAcl != null) {\n\t\t\t\t\tthis.list.splice(index, 0, inheritedAcl)\n\t\t\t\t}\n\t\t\t})\n\n\t\t},\n\t\tchangePermission(item, permission, $event) {\n\t\t\tconst index = this.list.indexOf(item)\n\t\t\tconst inherit = ($event < 2)\n\t\t\tconst allow = ($event & (0b01)) === 1\n\t\t\tconst bit = BinaryTools.firstHigh(permission)\n\t\t\titem = item.clone()\n\t\t\tif (inherit) {\n\t\t\t\titem.mask = BinaryTools.clear(item.mask, bit)\n\t\t\t\t// TODO check if: we can ignore permissions, since they are inherited\n\t\t\t} else {\n\t\t\t\titem.mask = BinaryTools.set(item.mask, bit)\n\t\t\t\tif (allow) {\n\t\t\t\t\titem.permissions = BinaryTools.set(item.permissions, bit)\n\t\t\t\t} else {\n\t\t\t\t\titem.permissions = BinaryTools.clear(item.permissions, bit)\n\t\t\t\t}\n\t\t\t}\n\t\t\titem.inherited = false\n\t\t\tVue.set(this.list, index, item)\n\t\t\tclient.propPatch(this.model, this.list).then(() => {\n\t\t\t\t// TODO block UI during save\n\t\t\t})\n\t\t},\n\t},\n}\n</script>\n\n<style scoped>\n\t#groupfolder-acl-container {\n\t\tmargin-bottom: 20px;\n\t}\n\n\t.groupfolder-entry {\n\t\theight: 44px;\n\t\twhite-space: normal;\n\t\tdisplay: inline-flex;\n\t\talign-items: center;\n\t\tposition: relative;\n\t}\n\n\t.avatar.icon-group-white {\n\t\tdisplay: inline-block;\n\t\tbackground-color: var(--color-primary, #0082c9);\n\t\tpadding: 16px;\n\t}\n\n\t.groupfolder-entry .username {\n\t\tpadding: 0 8px;\n\t\toverflow: hidden;\n\t\twhite-space: nowrap;\n\t\ttext-overflow: ellipsis;\n\t}\n\n\ttable {\n\t\twidth: 100%;\n\t\tmargin-top: -44px;\n\t\tmargin-bottom: 5px;\n\t}\n\n\ttable td, table th {\n\t\tpadding: 0\n\t}\n\n\tthead th {\n\t\theight: 44px;\n\t}\n\n\tthead th:first-child,\n\ttbody tr td:first-child {\n\t\twidth: 24px;\n\t\tpadding: 0;\n\t\tpadding-left: 4px;\n\t}\n\n\ttable .avatardiv {\n\t\tmargin-top: 6px;\n\t}\n\n\ttable thead th:nth-child(2),\n\ttable .username {\n\t\tpadding-left: 13px;\n\t\ttext-overflow: ellipsis;\n\t\toverflow: hidden;\n\t\tmax-width: 0;\n\t\tmin-width: 50px;\n\t}\n\n\t.state-column {\n\t\ttext-align: center;\n\t\twidth: 44px !important;\n\t\tpadding: 3px;\n\t}\n\n\tthead .state-column {\n\t\ttext-overflow: ellipsis;\n\t\toverflow: hidden;\n\t}\n\n\ttable button {\n\t\theight: 26px;\n\t\twidth: 24px !important;\n\t\tdisplay: block;\n\t\tborder-radius: 50%;\n\t\tmargin: auto;\n\t}\n\n\ta.icon-close {\n\t\tdisplay: inline-block;\n\t\theight: 24px;\n\t\twidth: 100%;\n\t\tvertical-align: middle;\n\t\tbackground-size: 12px;\n\t\topacity: .7;\n\t\tfloat: right;\n\t}\n\n\ta.icon-close:hover {\n\t\topacity: 1;\n\t}\n\n\t.multiselect {\n\t\tmargin-left: 44px;\n\t\twidth: calc(100% - 44px);\n\t}\n</style>\n","import mod from \"-!../../node_modules/babel-loader/lib/index.js!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SharingSidebarView.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/babel-loader/lib/index.js!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SharingSidebarView.vue?vue&type=script&lang=js&\"","\n      import API from \"!../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../node_modules/style-loader/dist/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../node_modules/style-loader/dist/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../node_modules/style-loader/dist/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../node_modules/style-loader/dist/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../node_modules/css-loader/dist/cjs.js!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SharingSidebarView.vue?vue&type=style&index=0&id=01e5fc40&scoped=true&lang=css&\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\n\n      options.insert = insertFn.bind(null, \"head\");\n    \noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../node_modules/css-loader/dist/cjs.js!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SharingSidebarView.vue?vue&type=style&index=0&id=01e5fc40&scoped=true&lang=css&\";\n       export default content && content.locals ? content.locals : undefined;\n","import { render, staticRenderFns } from \"./SharingSidebarView.vue?vue&type=template&id=01e5fc40&scoped=true&\"\nimport script from \"./SharingSidebarView.vue?vue&type=script&lang=js&\"\nexport * from \"./SharingSidebarView.vue?vue&type=script&lang=js&\"\nimport style0 from \"./SharingSidebarView.vue?vue&type=style&index=0&id=01e5fc40&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"01e5fc40\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return (_vm.aclEnabled && !_vm.loading)?_c('div',{attrs:{\"id\":\"groupfolder-acl-container\"}},[_vm._m(0),_vm._v(\" \"),_c('table',[_c('thead',[_c('tr',[_c('th'),_vm._v(\" \"),_c('th',[_vm._v(_vm._s(_vm.t('groupfolders', 'Group folder')))]),_vm._v(\" \"),_c('th',{directives:[{name:\"tooltip\",rawName:\"v-tooltip\",value:(_vm.t('groupfolders', 'Read')),expression:\"t('groupfolders', 'Read')\"}],staticClass:\"state-column\"},[_vm._v(\"\\n\\t\\t\\t\\t\\t\"+_vm._s(_vm.t('groupfolders', 'Read'))+\"\\n\\t\\t\\t\\t\")]),_vm._v(\" \"),_c('th',{directives:[{name:\"tooltip\",rawName:\"v-tooltip\",value:(_vm.t('groupfolders', 'Write')),expression:\"t('groupfolders', 'Write')\"}],staticClass:\"state-column\"},[_vm._v(\"\\n\\t\\t\\t\\t\\t\"+_vm._s(_vm.t('groupfolders', 'Write'))+\"\\n\\t\\t\\t\\t\")]),_vm._v(\" \"),(_vm.model.type === 'dir')?_c('th',{directives:[{name:\"tooltip\",rawName:\"v-tooltip\",value:(_vm.t('groupfolders', 'Create')),expression:\"t('groupfolders', 'Create')\"}],staticClass:\"state-column\"},[_vm._v(\"\\n\\t\\t\\t\\t\\t\"+_vm._s(_vm.t('groupfolders', 'Create'))+\"\\n\\t\\t\\t\\t\")]):_vm._e(),_vm._v(\" \"),_c('th',{directives:[{name:\"tooltip\",rawName:\"v-tooltip\",value:(_vm.t('groupfolders', 'Delete')),expression:\"t('groupfolders', 'Delete')\"}],staticClass:\"state-column\"},[_vm._v(\"\\n\\t\\t\\t\\t\\t\"+_vm._s(_vm.t('groupfolders', 'Delete'))+\"\\n\\t\\t\\t\\t\")]),_vm._v(\" \"),_c('th',{directives:[{name:\"tooltip\",rawName:\"v-tooltip\",value:(_vm.t('groupfolders', 'Share')),expression:\"t('groupfolders', 'Share')\"}],staticClass:\"state-column\"},[_vm._v(\"\\n\\t\\t\\t\\t\\t\"+_vm._s(_vm.t('groupfolders', 'Share'))+\"\\n\\t\\t\\t\\t\")]),_vm._v(\" \"),_c('th',{staticClass:\"state-column\"})])]),_vm._v(\" \"),(!_vm.isAdmin)?_c('tbody',[_c('tr',[_c('td',[_c('NcAvatar',{attrs:{\"user\":\"admin\",\"size\":24}})],1),_vm._v(\" \"),_c('td',{staticClass:\"username\"},[_vm._v(\"\\n\\t\\t\\t\\t\\t\"+_vm._s(_vm.t('groupfolders', 'You'))+\"\\n\\t\\t\\t\\t\")]),_vm._v(\" \"),_c('td',{staticClass:\"state-column\"},[_c('AclStateButton',{attrs:{\"state\":_vm.getState(_vm.OC.PERMISSION_READ, _vm.model.permissions, 1),\"read-only\":true}})],1),_vm._v(\" \"),_c('td',{staticClass:\"state-column\"},[_c('AclStateButton',{attrs:{\"state\":_vm.getState(_vm.OC.PERMISSION_UPDATE, _vm.model.permissions, 1),\"read-only\":true}})],1),_vm._v(\" \"),(_vm.model.type === 'dir')?_c('td',{staticClass:\"state-column\"},[_c('AclStateButton',{attrs:{\"state\":_vm.getState(_vm.OC.PERMISSION_CREATE, _vm.model.permissions, 1),\"read-only\":true}})],1):_vm._e(),_vm._v(\" \"),_c('td',{staticClass:\"state-column\"},[_c('AclStateButton',{attrs:{\"state\":_vm.getState(_vm.OC.PERMISSION_DELETE, _vm.model.permissions, 1),\"read-only\":true}})],1),_vm._v(\" \"),_c('td',{staticClass:\"state-column\"},[_c('AclStateButton',{attrs:{\"state\":_vm.getState(_vm.OC.PERMISSION_SHARE, _vm.model.permissions, 1),\"read-only\":true}})],1)])]):_c('tbody',_vm._l((_vm.list),function(item){return _c('tr',{key:item.mappingType + '-' + item.mappingId},[_c('td',[_c('NcAvatar',{attrs:{\"user\":item.mappingId,\"is-no-user\":item.mappingType !== 'user',\"size\":24}})],1),_vm._v(\" \"),_c('td',{directives:[{name:\"tooltip\",rawName:\"v-tooltip\",value:(_vm.getFullDisplayName(item.mappingDisplayName, item.mappingType)),expression:\"getFullDisplayName(item.mappingDisplayName, item.mappingType)\"}],staticClass:\"username\"},[_vm._v(\"\\n\\t\\t\\t\\t\\t\"+_vm._s(_vm.getFullDisplayName(item.mappingDisplayName, item.mappingType))+\"\\n\\t\\t\\t\\t\")]),_vm._v(\" \"),_c('td',{staticClass:\"state-column\"},[_c('AclStateButton',{attrs:{\"state\":_vm.getState(_vm.OC.PERMISSION_READ, item.permissions, item.mask),\"inherited\":item.inherited,\"disabled\":_vm.loading},on:{\"update\":function($event){return _vm.changePermission(item, _vm.OC.PERMISSION_READ, $event)}}})],1),_vm._v(\" \"),_c('td',{staticClass:\"state-column\"},[_c('AclStateButton',{attrs:{\"state\":_vm.getState(_vm.OC.PERMISSION_UPDATE, item.permissions, item.mask),\"inherited\":item.inherited,\"disabled\":_vm.loading},on:{\"update\":function($event){return _vm.changePermission(item, _vm.OC.PERMISSION_UPDATE, $event)}}})],1),_vm._v(\" \"),(_vm.model.type === 'dir')?_c('td',{staticClass:\"state-column\"},[_c('AclStateButton',{attrs:{\"state\":_vm.getState(_vm.OC.PERMISSION_CREATE, item.permissions, item.mask),\"inherited\":item.inherited,\"disabled\":_vm.loading},on:{\"update\":function($event){return _vm.changePermission(item, _vm.OC.PERMISSION_CREATE, $event)}}})],1):_vm._e(),_vm._v(\" \"),_c('td',{staticClass:\"state-column\"},[_c('AclStateButton',{attrs:{\"state\":_vm.getState(_vm.OC.PERMISSION_DELETE, item.permissions, item.mask),\"inherited\":item.inherited,\"disabled\":_vm.loading},on:{\"update\":function($event){return _vm.changePermission(item, _vm.OC.PERMISSION_DELETE, $event)}}})],1),_vm._v(\" \"),_c('td',{staticClass:\"state-column\"},[_c('AclStateButton',{attrs:{\"state\":_vm.getState(_vm.OC.PERMISSION_SHARE, item.permissions, item.mask),\"inherited\":item.inherited,\"disabled\":_vm.loading},on:{\"update\":function($event){return _vm.changePermission(item, _vm.OC.PERMISSION_SHARE, $event)}}})],1),_vm._v(\" \"),_c('td',{staticClass:\"state-column\"},[(item.inherited === false)?_c('NcButton',{attrs:{\"type\":\"tertiary\",\"v-tooltip\":_vm.t('groupfolders', 'Remove access rule'),\"aria-label\":_vm.t('groupfolders', 'Remove access rule')},on:{\"click\":function($event){return _vm.removeAcl(item)}},scopedSlots:_vm._u([{key:\"icon\",fn:function(){return [_c('Close',{attrs:{\"size\":16}})]},proxy:true}],null,true)}):_vm._e()],1)])}),0)]),_vm._v(\" \"),(_vm.isAdmin && !_vm.loading && !_vm.showAclCreate)?_c('NcButton',{on:{\"click\":_vm.toggleAclCreate},scopedSlots:_vm._u([{key:\"icon\",fn:function(){return [_c('Plus',{attrs:{\"size\":16}})]},proxy:true}],null,false,1065440311)},[_vm._v(\"\\n\\t\\t\"+_vm._s(_vm.t('groupfolders', 'Add advanced permission rule'))+\"\\n\\t\")]):_vm._e(),_vm._v(\" \"),(_vm.isAdmin && !_vm.loading)?_c('NcMultiselect',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.showAclCreate),expression:\"showAclCreate\"}],ref:\"select\",attrs:{\"options\":_vm.options,\"reset-after\":true,\"loading\":_vm.isSearching,\"internal-search\":false,\"placeholder\":_vm.t('groupfolders', 'Select a user or group'),\"track-by\":\"unique\"},on:{\"select\":_vm.createAcl,\"search-change\":_vm.searchMappings},scopedSlots:_vm._u([{key:\"singleLabel\",fn:function(props){return [_c('NcAvatar',{attrs:{\"user\":props.option.id,\"is-no-user\":props.option.type !== 'user'}}),_vm._v(\"\\n\\t\\t\\t\"+_vm._s(_vm.getFullDisplayName(props.option.displayname, props.option.type))+\"\\n\\t\\t\")]}},{key:\"option\",fn:function(props){return [_c('NcAvatar',{attrs:{\"user\":props.option.id,\"is-no-user\":props.option.type !== 'user'}}),_vm._v(\"\\n\\t\\t\\t\"+_vm._s(_vm.getFullDisplayName(props.option.displayname, props.option.type))+\"\\n\\t\\t\")]}}],null,false,3575459606),model:{value:(_vm.value),callback:function ($$v) {_vm.value=$$v},expression:\"value\"}}):_vm._e()],1):_vm._e()}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"groupfolder-entry\"},[_c('div',{staticClass:\"avatar icon-group-white\"}),_vm._v(\" \"),_c('span',{staticClass:\"username\"})])}]\n\nexport { render, staticRenderFns }","/*\n * @copyright Copyright (c) 2018 Julius Härtl <jus@bitgrid.net>\n *\n * @author Julius Härtl <jus@bitgrid.net>\n *\n * @license GNU AGPL version 3 or any later version\n *\n *  This program is free software: you can redistribute it and/or modify\n *  it under the terms of the GNU Affero General Public License as\n *  published by the Free Software Foundation, either version 3 of the\n *  License, or (at your option) any later version.\n *\n *  This program is distributed in the hope that it will be useful,\n *  but WITHOUT ANY WARRANTY; without even the implied warranty of\n *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *  GNU Affero General Public License for more details.\n *\n *  You should have received a copy of the GNU Affero General Public License\n *  along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nimport Vue from 'vue'\nimport SharingSidebarView from './components/SharingSidebarView.vue'\nimport { Tooltip } from '@nextcloud/vue'\nimport ClickOutside from 'vue-click-outside'\n\nVue.prototype.t = t\nVue.prototype.n = n\nVue.prototype.OC = OC\nVue.prototype.OCA = OCA\n\nVue.use(Tooltip)\nVue.directive('ClickOutside', ClickOutside)\n\nconst View = Vue.extend(SharingSidebarView)\n\nexport default View\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \"\\n.inherited[data-v-22b0874a] {\\n\\topacity: 0.5;\\n}\\n\", \"\",{\"version\":3,\"sources\":[\"webpack://./src/components/AclStateButton.vue\"],\"names\":[],\"mappings\":\";AA4IA;CACA,YAAA;AACA\",\"sourcesContent\":[\"<!--\\n  - @copyright Copyright (c) 2018 Julius Härtl <jus@bitgrid.net>\\n  -\\n  - @author Julius Härtl <jus@bitgrid.net>\\n  -\\n  - @license GNU AGPL version 3 or any later version\\n  -\\n  - This program is free software: you can redistribute it and/or modify\\n  - it under the terms of the GNU Affero General Public License as\\n  - published by the Free Software Foundation, either version 3 of the\\n  - License, or (at your option) any later version.\\n  -\\n  - This program is distributed in the hope that it will be useful,\\n  - but WITHOUT ANY WARRANTY; without even the implied warranty of\\n  - MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\\n  - GNU Affero General Public License for more details.\\n  -\\n  - You should have received a copy of the GNU Affero General Public License\\n  - along with this program. If not, see <http://www.gnu.org/licenses/>.\\n  -\\n  -->\\n<template>\\n\\t<div v-if=\\\"readOnly\\\">\\n\\t\\t<NcButton v-if=\\\"!isAllowed\\\" v-tooltip=\\\"t('groupfolders', 'Denied')\\\">\\n\\t\\t\\t<Cancel :size=\\\"16\\\" />\\n\\t\\t</NcButton>\\n\\t\\t<NcButton v-else v-tooltip=\\\"t('groupfolders', 'Allowed')\\\">\\n\\t\\t\\t<Check :size=\\\"16\\\" />\\n\\t\\t</NcButton>\\n\\t</div>\\n\\t<div v-else>\\n\\t\\t<NcActions :aria-label=\\\"label\\\" :v-tooltip=\\\"label\\\">\\n\\t\\t\\t<template #icon>\\n\\t\\t\\t\\t<component :is=\\\"icon\\\" :size=\\\"16\\\" />\\n\\t\\t\\t</template>\\n\\t\\t\\t<NcActionRadio name=\\\"state\\\"\\n\\t\\t\\t\\t:checked=\\\"state === STATES.INHERIT_ALLOW || state === STATES.INHERIT_DENY\\\"\\n\\t\\t\\t\\t:disabled=\\\"disabled\\\"\\n\\t\\t\\t\\t@change=\\\"$emit('update', STATES.INHERIT_ALLOW)\\\">\\n\\t\\t\\t\\t{{ t('groupfolders', 'Inherit permission') }}\\n\\t\\t\\t</NcActionRadio>\\n\\t\\t\\t<NcActionRadio name=\\\"state\\\"\\n\\t\\t\\t\\t:check=\\\"state === STATES.SELF_DENY\\\"\\n\\t\\t\\t\\t:disabled=\\\"disabled\\\"\\n\\t\\t\\t\\t@change=\\\"$emit('update', STATES.SELF_DENY)\\\">\\n\\t\\t\\t\\t{{ t('groupfolders', 'Deny') }}\\n\\t\\t\\t</NcActionRadio>\\n\\t\\t\\t<NcActionRadio name=\\\"state\\\"\\n\\t\\t\\t\\t:check=\\\"state === STATES.SELF_ALLOW\\\"\\n\\t\\t\\t\\t:disabled=\\\"disabled\\\"\\n\\t\\t\\t\\t@change=\\\"$emit('update', STATES.SELF_ALLOW)\\\">\\n\\t\\t\\t\\t{{ t('groupfolders', 'Allow') }}\\n\\t\\t\\t</NcActionRadio>\\n\\t\\t</NcActions>\\n\\t</div>\\n</template>\\n\\n<script>\\nimport Check from 'vue-material-design-icons/Check.vue'\\nimport Cancel from 'vue-material-design-icons/Cancel.vue'\\nimport NcButton from '@nextcloud/vue/dist/Components/NcButton.js'\\nimport NcPopoverMenu from '@nextcloud/vue/dist/Components/NcPopoverMenu.js'\\nimport NcActions from '@nextcloud/vue/dist/Components/NcActions.js'\\nimport NcActionRadio from '@nextcloud/vue/dist/Components/NcActionRadio.js'\\nimport Tooltip from '@nextcloud/vue/dist/Directives/Tooltip.js'\\n\\nconst STATES = {\\n\\tINHERIT_DENY: 0,\\n\\tINHERIT_ALLOW: 1,\\n\\tSELF_DENY: 2,\\n\\tSELF_ALLOW: 3,\\n}\\n\\nexport default {\\n\\tname: 'AclStateButton',\\n\\tdirectives: {\\n\\t\\ttooltip: Tooltip,\\n\\t},\\n\\tcomponents: {\\n\\t\\tNcPopoverMenu,\\n\\t\\tNcButton,\\n\\t\\tNcActions,\\n\\t\\tNcActionRadio,\\n\\t\\tCheck,\\n\\t\\tCancel,\\n\\t},\\n\\tprops: {\\n\\t\\tinherited: {\\n\\t\\t\\ttype: Boolean,\\n\\t\\t\\tdefault: false,\\n\\t\\t},\\n\\t\\tstate: {\\n\\t\\t\\ttype: Number,\\n\\t\\t\\tdefault: STATES.INHERIT_DENY,\\n\\t\\t},\\n\\t\\treadOnly: {\\n\\t\\t\\ttype: Boolean,\\n\\t\\t\\tdefault: false,\\n\\t\\t},\\n\\t\\tdisabled: {\\n\\t\\t\\ttype: Boolean,\\n\\t\\t\\tdefault: false,\\n\\t\\t},\\n\\t},\\n\\tdata() {\\n\\t\\treturn {\\n\\t\\t\\tSTATES,\\n\\t\\t}\\n\\t},\\n\\tcomputed: {\\n\\t\\tisAllowed() {\\n\\t\\t\\treturn this.state & 1\\n\\t\\t},\\n\\t\\ticon() {\\n\\t\\t\\tswitch (this.state) {\\n\\t\\t\\tcase STATES.INHERIT_ALLOW:\\n\\t\\t\\tcase STATES.SELF_ALLOW:\\n\\t\\t\\t\\treturn Check\\n\\t\\t\\tdefault:\\n\\t\\t\\t\\treturn Cancel\\n\\t\\t\\t}\\n\\t\\t},\\n\\t\\tlabel() {\\n\\t\\t\\tswitch (this.state) {\\n\\t\\t\\tcase STATES.INHERIT_DENY:\\n\\t\\t\\t\\treturn t('groupfolders', 'Denied (Inherited permission)')\\n\\t\\t\\tcase STATES.INHERIT_ALLOW:\\n\\t\\t\\t\\treturn t('groupfolders', 'Allowed (Inherited permission)')\\n\\t\\t\\tcase STATES.SELF_DENY:\\n\\t\\t\\t\\treturn t('groupfolders', 'Denied')\\n\\t\\t\\tcase STATES.SELF_ALLOW:\\n\\t\\t\\t\\treturn t('groupfolders', 'Allowed')\\n\\t\\t\\t}\\n\\t\\t\\treturn ''\\n\\t\\t},\\n\\t},\\n}\\n</script>\\n\\n<style scoped>\\n\\t.inherited {\\n\\t\\topacity: 0.5;\\n\\t}\\n</style>\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \"\\n#groupfolder-acl-container[data-v-01e5fc40] {\\n\\tmargin-bottom: 20px;\\n}\\n.groupfolder-entry[data-v-01e5fc40] {\\n\\theight: 44px;\\n\\twhite-space: normal;\\n\\tdisplay: inline-flex;\\n\\talign-items: center;\\n\\tposition: relative;\\n}\\n.avatar.icon-group-white[data-v-01e5fc40] {\\n\\tdisplay: inline-block;\\n\\tbackground-color: var(--color-primary, #0082c9);\\n\\tpadding: 16px;\\n}\\n.groupfolder-entry .username[data-v-01e5fc40] {\\n\\tpadding: 0 8px;\\n\\toverflow: hidden;\\n\\twhite-space: nowrap;\\n\\ttext-overflow: ellipsis;\\n}\\ntable[data-v-01e5fc40] {\\n\\twidth: 100%;\\n\\tmargin-top: -44px;\\n\\tmargin-bottom: 5px;\\n}\\ntable td[data-v-01e5fc40], table th[data-v-01e5fc40] {\\n\\tpadding: 0\\n}\\nthead th[data-v-01e5fc40] {\\n\\theight: 44px;\\n}\\nthead th[data-v-01e5fc40]:first-child,\\ntbody tr td[data-v-01e5fc40]:first-child {\\n\\twidth: 24px;\\n\\tpadding: 0;\\n\\tpadding-left: 4px;\\n}\\ntable .avatardiv[data-v-01e5fc40] {\\n\\tmargin-top: 6px;\\n}\\ntable thead th[data-v-01e5fc40]:nth-child(2),\\ntable .username[data-v-01e5fc40] {\\n\\tpadding-left: 13px;\\n\\ttext-overflow: ellipsis;\\n\\toverflow: hidden;\\n\\tmax-width: 0;\\n\\tmin-width: 50px;\\n}\\n.state-column[data-v-01e5fc40] {\\n\\ttext-align: center;\\n\\twidth: 44px !important;\\n\\tpadding: 3px;\\n}\\nthead .state-column[data-v-01e5fc40] {\\n\\ttext-overflow: ellipsis;\\n\\toverflow: hidden;\\n}\\ntable button[data-v-01e5fc40] {\\n\\theight: 26px;\\n\\twidth: 24px !important;\\n\\tdisplay: block;\\n\\tborder-radius: 50%;\\n\\tmargin: auto;\\n}\\na.icon-close[data-v-01e5fc40] {\\n\\tdisplay: inline-block;\\n\\theight: 24px;\\n\\twidth: 100%;\\n\\tvertical-align: middle;\\n\\tbackground-size: 12px;\\n\\topacity: .7;\\n\\tfloat: right;\\n}\\na.icon-close[data-v-01e5fc40]:hover {\\n\\topacity: 1;\\n}\\n.multiselect[data-v-01e5fc40] {\\n\\tmargin-left: 44px;\\n\\twidth: calc(100% - 44px);\\n}\\n\", \"\",{\"version\":3,\"sources\":[\"webpack://./src/components/SharingSidebarView.vue\"],\"names\":[],\"mappings\":\";AAsWA;CACA,mBAAA;AACA;AAEA;CACA,YAAA;CACA,mBAAA;CACA,oBAAA;CACA,mBAAA;CACA,kBAAA;AACA;AAEA;CACA,qBAAA;CACA,+CAAA;CACA,aAAA;AACA;AAEA;CACA,cAAA;CACA,gBAAA;CACA,mBAAA;CACA,uBAAA;AACA;AAEA;CACA,WAAA;CACA,iBAAA;CACA,kBAAA;AACA;AAEA;CACA;AACA;AAEA;CACA,YAAA;AACA;AAEA;;CAEA,WAAA;CACA,UAAA;CACA,iBAAA;AACA;AAEA;CACA,eAAA;AACA;AAEA;;CAEA,kBAAA;CACA,uBAAA;CACA,gBAAA;CACA,YAAA;CACA,eAAA;AACA;AAEA;CACA,kBAAA;CACA,sBAAA;CACA,YAAA;AACA;AAEA;CACA,uBAAA;CACA,gBAAA;AACA;AAEA;CACA,YAAA;CACA,sBAAA;CACA,cAAA;CACA,kBAAA;CACA,YAAA;AACA;AAEA;CACA,qBAAA;CACA,YAAA;CACA,WAAA;CACA,sBAAA;CACA,qBAAA;CACA,WAAA;CACA,YAAA;AACA;AAEA;CACA,UAAA;AACA;AAEA;CACA,iBAAA;CACA,wBAAA;AACA\",\"sourcesContent\":[\"<!--\\n  - @copyright Copyright (c) 2018 Julius Härtl <jus@bitgrid.net>\\n  -\\n  - @author Julius Härtl <jus@bitgrid.net>\\n  -\\n  - @license GNU AGPL version 3 or any later version\\n  -\\n  - This program is free software: you can redistribute it and/or modify\\n  - it under the terms of the GNU Affero General Public License as\\n  - published by the Free Software Foundation, either version 3 of the\\n  - License, or (at your option) any later version.\\n  -\\n  - This program is distributed in the hope that it will be useful,\\n  - but WITHOUT ANY WARRANTY; without even the implied warranty of\\n  - MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\\n  - GNU Affero General Public License for more details.\\n  -\\n  - You should have received a copy of the GNU Affero General Public License\\n  - along with this program. If not, see <http://www.gnu.org/licenses/>.\\n  -\\n  -->\\n<template>\\n\\t<div v-if=\\\"aclEnabled && !loading\\\" id=\\\"groupfolder-acl-container\\\">\\n\\t\\t<div class=\\\"groupfolder-entry\\\">\\n\\t\\t\\t<div class=\\\"avatar icon-group-white\\\" />\\n\\t\\t\\t<span class=\\\"username\\\" />\\n\\t\\t</div>\\n\\t\\t<table>\\n\\t\\t\\t<thead>\\n\\t\\t\\t\\t<tr>\\n\\t\\t\\t\\t\\t<th />\\n\\t\\t\\t\\t\\t<th>{{ t('groupfolders', 'Group folder') }}</th>\\n\\t\\t\\t\\t\\t<th v-tooltip=\\\"t('groupfolders', 'Read')\\\" class=\\\"state-column\\\">\\n\\t\\t\\t\\t\\t\\t{{ t('groupfolders', 'Read') }}\\n\\t\\t\\t\\t\\t</th>\\n\\t\\t\\t\\t\\t<th v-tooltip=\\\"t('groupfolders', 'Write')\\\" class=\\\"state-column\\\">\\n\\t\\t\\t\\t\\t\\t{{ t('groupfolders', 'Write') }}\\n\\t\\t\\t\\t\\t</th>\\n\\t\\t\\t\\t\\t<th v-if=\\\"model.type === 'dir'\\\" v-tooltip=\\\"t('groupfolders', 'Create')\\\" class=\\\"state-column\\\">\\n\\t\\t\\t\\t\\t\\t{{\\n\\t\\t\\t\\t\\t\\t\\tt('groupfolders', 'Create') }}\\n\\t\\t\\t\\t\\t</th>\\n\\t\\t\\t\\t\\t<th v-tooltip=\\\"t('groupfolders', 'Delete')\\\" class=\\\"state-column\\\">\\n\\t\\t\\t\\t\\t\\t{{ t('groupfolders', 'Delete') }}\\n\\t\\t\\t\\t\\t</th>\\n\\t\\t\\t\\t\\t<th v-tooltip=\\\"t('groupfolders', 'Share')\\\" class=\\\"state-column\\\">\\n\\t\\t\\t\\t\\t\\t{{ t('groupfolders', 'Share') }}\\n\\t\\t\\t\\t\\t</th>\\n\\t\\t\\t\\t\\t<th class=\\\"state-column\\\" />\\n\\t\\t\\t\\t</tr>\\n\\t\\t\\t</thead>\\n\\t\\t\\t<tbody v-if=\\\"!isAdmin\\\">\\n\\t\\t\\t\\t<tr>\\n\\t\\t\\t\\t\\t<td>\\n\\t\\t\\t\\t\\t\\t<NcAvatar user=\\\"admin\\\" :size=\\\"24\\\" />\\n\\t\\t\\t\\t\\t</td>\\n\\t\\t\\t\\t\\t<td class=\\\"username\\\">\\n\\t\\t\\t\\t\\t\\t{{ t('groupfolders', 'You') }}\\n\\t\\t\\t\\t\\t</td>\\n\\t\\t\\t\\t\\t<td class=\\\"state-column\\\">\\n\\t\\t\\t\\t\\t\\t<AclStateButton :state=\\\"getState(OC.PERMISSION_READ, model.permissions, 1)\\\" :read-only=\\\"true\\\" />\\n\\t\\t\\t\\t\\t</td>\\n\\t\\t\\t\\t\\t<td class=\\\"state-column\\\">\\n\\t\\t\\t\\t\\t\\t<AclStateButton :state=\\\"getState(OC.PERMISSION_UPDATE, model.permissions, 1)\\\" :read-only=\\\"true\\\" />\\n\\t\\t\\t\\t\\t</td>\\n\\t\\t\\t\\t\\t<td v-if=\\\"model.type === 'dir'\\\" class=\\\"state-column\\\">\\n\\t\\t\\t\\t\\t\\t<AclStateButton :state=\\\"getState(OC.PERMISSION_CREATE, model.permissions, 1)\\\" :read-only=\\\"true\\\" />\\n\\t\\t\\t\\t\\t</td>\\n\\t\\t\\t\\t\\t<td class=\\\"state-column\\\">\\n\\t\\t\\t\\t\\t\\t<AclStateButton :state=\\\"getState(OC.PERMISSION_DELETE, model.permissions, 1)\\\" :read-only=\\\"true\\\" />\\n\\t\\t\\t\\t\\t</td>\\n\\t\\t\\t\\t\\t<td class=\\\"state-column\\\">\\n\\t\\t\\t\\t\\t\\t<AclStateButton :state=\\\"getState(OC.PERMISSION_SHARE, model.permissions, 1)\\\" :read-only=\\\"true\\\" />\\n\\t\\t\\t\\t\\t</td>\\n\\t\\t\\t\\t</tr>\\n\\t\\t\\t</tbody>\\n\\t\\t\\t<tbody v-else>\\n\\t\\t\\t\\t<tr v-for=\\\"item in list\\\" :key=\\\"item.mappingType + '-' + item.mappingId\\\">\\n\\t\\t\\t\\t\\t<td>\\n\\t\\t\\t\\t\\t\\t<NcAvatar :user=\\\"item.mappingId\\\" :is-no-user=\\\"item.mappingType !== 'user'\\\" :size=\\\"24\\\" />\\n\\t\\t\\t\\t\\t</td>\\n\\t\\t\\t\\t\\t<td v-tooltip=\\\"getFullDisplayName(item.mappingDisplayName, item.mappingType)\\\" class=\\\"username\\\">\\n\\t\\t\\t\\t\\t\\t{{ getFullDisplayName(item.mappingDisplayName, item.mappingType) }}\\n\\t\\t\\t\\t\\t</td>\\n\\t\\t\\t\\t\\t<td class=\\\"state-column\\\">\\n\\t\\t\\t\\t\\t\\t<AclStateButton :state=\\\"getState(OC.PERMISSION_READ, item.permissions, item.mask)\\\"\\n\\t\\t\\t\\t\\t\\t\\t:inherited=\\\"item.inherited\\\"\\n\\t\\t\\t\\t\\t\\t\\t:disabled=\\\"loading\\\"\\n\\t\\t\\t\\t\\t\\t\\t@update=\\\"changePermission(item, OC.PERMISSION_READ, $event)\\\" />\\n\\t\\t\\t\\t\\t</td>\\n\\t\\t\\t\\t\\t<td class=\\\"state-column\\\">\\n\\t\\t\\t\\t\\t\\t<AclStateButton :state=\\\"getState(OC.PERMISSION_UPDATE, item.permissions, item.mask)\\\"\\n\\t\\t\\t\\t\\t\\t\\t:inherited=\\\"item.inherited\\\"\\n\\t\\t\\t\\t\\t\\t\\t:disabled=\\\"loading\\\"\\n\\t\\t\\t\\t\\t\\t\\t@update=\\\"changePermission(item, OC.PERMISSION_UPDATE, $event)\\\" />\\n\\t\\t\\t\\t\\t</td>\\n\\t\\t\\t\\t\\t<td v-if=\\\"model.type === 'dir'\\\" class=\\\"state-column\\\">\\n\\t\\t\\t\\t\\t\\t<AclStateButton :state=\\\"getState(OC.PERMISSION_CREATE, item.permissions, item.mask)\\\"\\n\\t\\t\\t\\t\\t\\t\\t:inherited=\\\"item.inherited\\\"\\n\\t\\t\\t\\t\\t\\t\\t:disabled=\\\"loading\\\"\\n\\t\\t\\t\\t\\t\\t\\t@update=\\\"changePermission(item, OC.PERMISSION_CREATE, $event)\\\" />\\n\\t\\t\\t\\t\\t</td>\\n\\t\\t\\t\\t\\t<td class=\\\"state-column\\\">\\n\\t\\t\\t\\t\\t\\t<AclStateButton :state=\\\"getState(OC.PERMISSION_DELETE, item.permissions, item.mask)\\\"\\n\\t\\t\\t\\t\\t\\t\\t:inherited=\\\"item.inherited\\\"\\n\\t\\t\\t\\t\\t\\t\\t:disabled=\\\"loading\\\"\\n\\t\\t\\t\\t\\t\\t\\t@update=\\\"changePermission(item, OC.PERMISSION_DELETE, $event)\\\" />\\n\\t\\t\\t\\t\\t</td>\\n\\t\\t\\t\\t\\t<td class=\\\"state-column\\\">\\n\\t\\t\\t\\t\\t\\t<AclStateButton :state=\\\"getState(OC.PERMISSION_SHARE, item.permissions, item.mask)\\\"\\n\\t\\t\\t\\t\\t\\t\\t:inherited=\\\"item.inherited\\\"\\n\\t\\t\\t\\t\\t\\t\\t:disabled=\\\"loading\\\"\\n\\t\\t\\t\\t\\t\\t\\t@update=\\\"changePermission(item, OC.PERMISSION_SHARE, $event)\\\" />\\n\\t\\t\\t\\t\\t</td>\\n\\t\\t\\t\\t\\t<td class=\\\"state-column\\\">\\n\\t\\t\\t\\t\\t\\t<NcButton v-if=\\\"item.inherited === false\\\"\\n\\t\\t\\t\\t\\t\\t\\ttype=\\\"tertiary\\\"\\n\\t\\t\\t\\t\\t\\t\\t:v-tooltip=\\\"t('groupfolders', 'Remove access rule')\\\"\\n\\t\\t\\t\\t\\t\\t\\t:aria-label=\\\"t('groupfolders', 'Remove access rule')\\\"\\n\\t\\t\\t\\t\\t\\t\\t@click=\\\"removeAcl(item)\\\">\\n\\t\\t\\t\\t\\t\\t\\t<template #icon>\\n\\t\\t\\t\\t\\t\\t\\t\\t<Close :size=\\\"16\\\" />\\n\\t\\t\\t\\t\\t\\t\\t</template>\\n\\t\\t\\t\\t\\t\\t</NcButton>\\n\\t\\t\\t\\t\\t</td>\\n\\t\\t\\t\\t</tr>\\n\\t\\t\\t</tbody>\\n\\t\\t</table>\\n\\t\\t<NcButton v-if=\\\"isAdmin && !loading && !showAclCreate\\\"\\n\\t\\t\\t@click=\\\"toggleAclCreate\\\">\\n\\t\\t\\t<template #icon>\\n\\t\\t\\t\\t<Plus :size=\\\"16\\\" />\\n\\t\\t\\t</template>\\n\\t\\t\\t{{ t('groupfolders', 'Add advanced permission rule') }}\\n\\t\\t</NcButton>\\n\\t\\t<NcMultiselect v-if=\\\"isAdmin && !loading\\\"\\n\\t\\t\\tv-show=\\\"showAclCreate\\\"\\n\\t\\t\\tref=\\\"select\\\"\\n\\t\\t\\tv-model=\\\"value\\\"\\n\\t\\t\\t:options=\\\"options\\\"\\n\\t\\t\\t:reset-after=\\\"true\\\"\\n\\t\\t\\t:loading=\\\"isSearching\\\"\\n\\t\\t\\t:internal-search=\\\"false\\\"\\n\\t\\t\\t:placeholder=\\\"t('groupfolders', 'Select a user or group')\\\"\\n\\t\\t\\ttrack-by=\\\"unique\\\"\\n\\t\\t\\t@select=\\\"createAcl\\\"\\n\\t\\t\\t@search-change=\\\"searchMappings\\\">\\n\\t\\t\\t<template slot=\\\"singleLabel\\\" slot-scope=\\\"props\\\">\\n\\t\\t\\t\\t<NcAvatar :user=\\\"props.option.id\\\" :is-no-user=\\\"props.option.type !== 'user'\\\" />\\n\\t\\t\\t\\t{{ getFullDisplayName(props.option.displayname, props.option.type) }}\\n\\t\\t\\t</template>\\n\\t\\t\\t<template slot=\\\"option\\\" slot-scope=\\\"props\\\">\\n\\t\\t\\t\\t<NcAvatar :user=\\\"props.option.id\\\" :is-no-user=\\\"props.option.type !== 'user'\\\" />\\n\\t\\t\\t\\t{{ getFullDisplayName(props.option.displayname, props.option.type) }}\\n\\t\\t\\t</template>\\n\\t\\t</NcMultiselect>\\n\\t</div>\\n</template>\\n\\n<script>\\nimport Vue from 'vue'\\nimport axios from '@nextcloud/axios'\\nimport { generateUrl } from '@nextcloud/router'\\nimport AclStateButton from './AclStateButton.vue'\\nimport Rule from './../model/Rule.js'\\nimport BinaryTools from './../BinaryTools.js'\\nimport client from './../client.js'\\nimport NcButton from '@nextcloud/vue/dist/Components/NcButton.js'\\nimport NcAvatar from '@nextcloud/vue/dist/Components/NcAvatar.js'\\nimport NcMultiselect from '@nextcloud/vue/dist/Components/NcMultiselect.js'\\nimport Tooltip from '@nextcloud/vue/dist/Directives/Tooltip.js'\\nimport Plus from 'vue-material-design-icons/Plus.vue'\\nimport Close from 'vue-material-design-icons/Close.vue'\\n\\nlet searchRequestCancelSource = null\\n\\nexport default {\\n\\tname: 'SharingSidebarView',\\n\\tdirectives: {\\n\\t\\ttooltip: Tooltip,\\n\\t},\\n\\tcomponents: {\\n\\t\\tNcAvatar,\\n\\t\\tNcMultiselect,\\n\\t\\tNcButton,\\n\\t\\tAclStateButton,\\n\\t\\tPlus,\\n\\t\\tClose,\\n\\t},\\n\\tprops: {\\n\\t\\tfileInfo: {\\n\\t\\t\\ttype: Object,\\n\\t\\t\\trequired: true,\\n\\t\\t},\\n\\t},\\n\\tdata() {\\n\\t\\treturn {\\n\\t\\t\\taclEnabled: false,\\n\\t\\t\\taclCanManage: false,\\n\\t\\t\\tshowAclCreate: false,\\n\\t\\t\\tgroupFolderId: null,\\n\\t\\t\\tloading: false,\\n\\t\\t\\tisSearching: false,\\n\\t\\t\\toptions: [],\\n\\t\\t\\tvalue: null,\\n\\t\\t\\tmodel: null,\\n\\t\\t\\tlist: [],\\n\\t\\t}\\n\\t},\\n\\tcomputed: {\\n\\t\\tisAdmin() {\\n\\t\\t\\treturn this.aclCanManage\\n\\t\\t},\\n\\t\\tisInherited() {\\n\\t\\t\\treturn (permission, permissions, mask) => {\\n\\t\\t\\t\\treturn (permission & ~mask) === 0\\n\\t\\t\\t}\\n\\t\\t},\\n\\t\\tisAllowed() {\\n\\t\\t\\treturn (permission, permissions) => {\\n\\t\\t\\t\\treturn (permission & permissions) > 0\\n\\t\\t\\t}\\n\\t\\t},\\n\\t\\tgetState() {\\n\\t\\t\\treturn (permission, permissions, mask) => {\\n\\t\\t\\t\\tconst inheritance = this.isInherited(permission, permissions, mask) << 1\\n\\t\\t\\t\\tconst permitted = this.isAllowed(permission, permissions)\\n\\t\\t\\t\\treturn inheritance | permitted\\n\\t\\t\\t}\\n\\t\\t},\\n\\t},\\n\\twatch: {\\n\\t\\tfileInfo(/* newVal, oldVal */) {\\n\\t\\t\\t// reload ACL entries if file changes\\n\\t\\t\\tthis.loadAcls()\\n\\t\\t},\\n\\t},\\n\\tbeforeMount() {\\n\\t\\t// load ACL entries for initial file\\n\\t\\tthis.loadAcls()\\n\\t},\\n\\tmethods: {\\n\\t\\tloadAcls() {\\n\\t\\t\\tthis.options = []\\n\\t\\t\\tthis.loading = true\\n\\t\\t\\tthis.model = JSON.parse(JSON.stringify(this.fileInfo))\\n\\t\\t\\tclient.propFind(this.model).then((data) => {\\n\\t\\t\\t\\tif (data.acls) {\\n\\t\\t\\t\\t\\tthis.list = data.acls\\n\\t\\t\\t\\t}\\n\\t\\t\\t\\tthis.inheritedAclsById = data.inheritedAclsById\\n\\t\\t\\t\\tthis.aclEnabled = data.aclEnabled\\n\\t\\t\\t\\tthis.aclCanManage = data.aclCanManage\\n\\t\\t\\t\\tthis.groupFolderId = data.groupFolderId\\n\\t\\t\\t\\tthis.loading = false\\n\\t\\t\\t\\tthis.searchMappings('')\\n\\t\\t\\t})\\n\\t\\t},\\n\\t\\tgetFullDisplayName(displayName, type) {\\n\\t\\t\\tif (type === 'group') {\\n\\t\\t\\t\\treturn `${displayName} (${t('groupfolders', 'Group')})`\\n\\t\\t\\t}\\n\\n\\t\\t\\treturn displayName\\n\\t\\t},\\n\\t\\tsearchMappings(query) {\\n\\t\\t\\tif (searchRequestCancelSource) {\\n\\t\\t\\t\\tsearchRequestCancelSource.cancel('Operation canceled by another search request.')\\n\\t\\t\\t}\\n\\t\\t\\tsearchRequestCancelSource = axios.CancelToken.source()\\n\\t\\t\\tthis.isSearching = true\\n\\t\\t\\taxios.get(generateUrl(`apps/groupfolders/folders/${this.groupFolderId}/search`) + '?format=json&search=' + query, {\\n\\t\\t\\t\\tcancelToken: searchRequestCancelSource.token,\\n\\t\\t\\t}).then((result) => {\\n\\t\\t\\t\\tthis.isSearching = false\\n\\t\\t\\t\\tconst groups = Object.values(result.data.ocs.data.groups).map((group) => {\\n\\t\\t\\t\\t\\treturn {\\n\\t\\t\\t\\t\\t\\tunique: 'group:' + group.gid,\\n\\t\\t\\t\\t\\t\\ttype: 'group',\\n\\t\\t\\t\\t\\t\\tid: group.gid,\\n\\t\\t\\t\\t\\t\\tdisplayname: group.displayname,\\n\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t})\\n\\t\\t\\t\\tconst users = Object.values(result.data.ocs.data.users).map((user) => {\\n\\t\\t\\t\\t\\treturn {\\n\\t\\t\\t\\t\\t\\tunique: 'user:' + user.uid,\\n\\t\\t\\t\\t\\t\\ttype: 'user',\\n\\t\\t\\t\\t\\t\\tid: user.uid,\\n\\t\\t\\t\\t\\t\\tdisplayname: user.displayname,\\n\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t})\\n\\t\\t\\t\\tthis.options = [...groups, ...users].filter((entry) => {\\n\\t\\t\\t\\t\\t// filter out existing acl rules\\n\\t\\t\\t\\t\\treturn !this.list.find((existingAcl) => entry.unique === existingAcl.getUniqueMappingIdentifier())\\n\\t\\t\\t\\t})\\n\\t\\t\\t}).catch((error) => {\\n\\t\\t\\t\\tif (!axios.isCancel(error)) {\\n\\t\\t\\t\\t\\tconsole.error('Failed to l search results for groupfolder ACL')\\n\\t\\t\\t\\t}\\n\\t\\t\\t})\\n\\t\\t},\\n\\t\\ttoggleAclCreate() {\\n\\t\\t\\tthis.showAclCreate = !this.showAclCreate\\n\\t\\t\\tVue.nextTick(() => {\\n\\t\\t\\t\\tthis.$refs.select.$el.focus()\\n\\t\\t\\t})\\n\\t\\t},\\n\\t\\tcreateAcl(option) {\\n\\t\\t\\tconst rule = new Rule()\\n\\t\\t\\trule.fromValues(option.type, option.id, option.displayname, 0b00000, 0b11111)\\n\\t\\t\\tthis.list.push(rule)\\n\\t\\t\\tclient.propPatch(this.model, this.list).then(() => {\\n\\t\\t\\t\\tthis.showAclCreate = false\\n\\t\\t\\t})\\n\\t\\t},\\n\\t\\tremoveAcl(rule) {\\n\\t\\t\\tconst index = this.list.indexOf(rule)\\n\\t\\t\\tconst list = this.list.concat([]) // shallow clone\\n\\t\\t\\tif (index > -1) {\\n\\t\\t\\t\\tlist.splice(index, 1)\\n\\t\\t\\t}\\n\\t\\t\\tclient.propPatch(this.model, list).then(() => {\\n\\t\\t\\t\\tthis.list.splice(index, 1)\\n\\t\\t\\t\\tconst inheritedAcl = this.inheritedAclsById[rule.getUniqueMappingIdentifier()]\\n\\t\\t\\t\\tif (inheritedAcl != null) {\\n\\t\\t\\t\\t\\tthis.list.splice(index, 0, inheritedAcl)\\n\\t\\t\\t\\t}\\n\\t\\t\\t})\\n\\n\\t\\t},\\n\\t\\tchangePermission(item, permission, $event) {\\n\\t\\t\\tconst index = this.list.indexOf(item)\\n\\t\\t\\tconst inherit = ($event < 2)\\n\\t\\t\\tconst allow = ($event & (0b01)) === 1\\n\\t\\t\\tconst bit = BinaryTools.firstHigh(permission)\\n\\t\\t\\titem = item.clone()\\n\\t\\t\\tif (inherit) {\\n\\t\\t\\t\\titem.mask = BinaryTools.clear(item.mask, bit)\\n\\t\\t\\t\\t// TODO check if: we can ignore permissions, since they are inherited\\n\\t\\t\\t} else {\\n\\t\\t\\t\\titem.mask = BinaryTools.set(item.mask, bit)\\n\\t\\t\\t\\tif (allow) {\\n\\t\\t\\t\\t\\titem.permissions = BinaryTools.set(item.permissions, bit)\\n\\t\\t\\t\\t} else {\\n\\t\\t\\t\\t\\titem.permissions = BinaryTools.clear(item.permissions, bit)\\n\\t\\t\\t\\t}\\n\\t\\t\\t}\\n\\t\\t\\titem.inherited = false\\n\\t\\t\\tVue.set(this.list, index, item)\\n\\t\\t\\tclient.propPatch(this.model, this.list).then(() => {\\n\\t\\t\\t\\t// TODO block UI during save\\n\\t\\t\\t})\\n\\t\\t},\\n\\t},\\n}\\n</script>\\n\\n<style scoped>\\n\\t#groupfolder-acl-container {\\n\\t\\tmargin-bottom: 20px;\\n\\t}\\n\\n\\t.groupfolder-entry {\\n\\t\\theight: 44px;\\n\\t\\twhite-space: normal;\\n\\t\\tdisplay: inline-flex;\\n\\t\\talign-items: center;\\n\\t\\tposition: relative;\\n\\t}\\n\\n\\t.avatar.icon-group-white {\\n\\t\\tdisplay: inline-block;\\n\\t\\tbackground-color: var(--color-primary, #0082c9);\\n\\t\\tpadding: 16px;\\n\\t}\\n\\n\\t.groupfolder-entry .username {\\n\\t\\tpadding: 0 8px;\\n\\t\\toverflow: hidden;\\n\\t\\twhite-space: nowrap;\\n\\t\\ttext-overflow: ellipsis;\\n\\t}\\n\\n\\ttable {\\n\\t\\twidth: 100%;\\n\\t\\tmargin-top: -44px;\\n\\t\\tmargin-bottom: 5px;\\n\\t}\\n\\n\\ttable td, table th {\\n\\t\\tpadding: 0\\n\\t}\\n\\n\\tthead th {\\n\\t\\theight: 44px;\\n\\t}\\n\\n\\tthead th:first-child,\\n\\ttbody tr td:first-child {\\n\\t\\twidth: 24px;\\n\\t\\tpadding: 0;\\n\\t\\tpadding-left: 4px;\\n\\t}\\n\\n\\ttable .avatardiv {\\n\\t\\tmargin-top: 6px;\\n\\t}\\n\\n\\ttable thead th:nth-child(2),\\n\\ttable .username {\\n\\t\\tpadding-left: 13px;\\n\\t\\ttext-overflow: ellipsis;\\n\\t\\toverflow: hidden;\\n\\t\\tmax-width: 0;\\n\\t\\tmin-width: 50px;\\n\\t}\\n\\n\\t.state-column {\\n\\t\\ttext-align: center;\\n\\t\\twidth: 44px !important;\\n\\t\\tpadding: 3px;\\n\\t}\\n\\n\\tthead .state-column {\\n\\t\\ttext-overflow: ellipsis;\\n\\t\\toverflow: hidden;\\n\\t}\\n\\n\\ttable button {\\n\\t\\theight: 26px;\\n\\t\\twidth: 24px !important;\\n\\t\\tdisplay: block;\\n\\t\\tborder-radius: 50%;\\n\\t\\tmargin: auto;\\n\\t}\\n\\n\\ta.icon-close {\\n\\t\\tdisplay: inline-block;\\n\\t\\theight: 24px;\\n\\t\\twidth: 100%;\\n\\t\\tvertical-align: middle;\\n\\t\\tbackground-size: 12px;\\n\\t\\topacity: .7;\\n\\t\\tfloat: right;\\n\\t}\\n\\n\\ta.icon-close:hover {\\n\\t\\topacity: 1;\\n\\t}\\n\\n\\t.multiselect {\\n\\t\\tmargin-left: 44px;\\n\\t\\twidth: calc(100% - 44px);\\n\\t}\\n</style>\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n"],"names":["options","styleTagTransform","setAttributes","insert","domAPI","insertStyleElement","_vm","this","_h","$createElement","_c","_self","isAllowed","directives","name","rawName","value","t","expression","attrs","label","scopedSlots","_u","key","fn","icon","tag","proxy","_v","state","STATES","INHERIT_ALLOW","INHERIT_DENY","disabled","on","$event","$emit","_s","SELF_DENY","SELF_ALLOW","toString","num","padStart","firstHigh","position","test","bit","set","clear","toggle","aclEnabled","loading","_m","staticClass","model","type","_e","isAdmin","_l","item","mappingType","mappingId","getFullDisplayName","mappingDisplayName","getState","OC","PERMISSION_READ","permissions","mask","inherited","changePermission","PERMISSION_UPDATE","PERMISSION_CREATE","PERMISSION_DELETE","PERMISSION_SHARE","removeAcl","showAclCreate","toggleAclCreate","ref","isSearching","createAcl","searchMappings","props","option","id","displayname","callback","$$v","Vue","n","OCA","Tooltip","ClickOutside","SharingSidebarView","___CSS_LOADER_EXPORT___","push","module"],"sourceRoot":""}